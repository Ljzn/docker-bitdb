version: '3'
services:
  mongo:
    image: mongo
    container_name: mongo
    restart: always
    networks:
      - bitdb
    volumes:
       - ./mongo:/data/db
  bitcoin-abc:
    build:
      context: "./docker"
      dockerfile: "./Dockerfile.bitcoin-abc"
    image: bitcoin-abc
    container_name: bitcoin-abc
    command: bitcoind
    networks:
      - bitdb
    restart: always
    ports:
      - 8333:8333
    volumes:
       - ./bitcoin:/root/.bitcoin
  bitdb:
    build:
      context: "./docker"
      dockerfile: "./Dockerfile.bitdb"
    image: bitdb
    container_name: bitdb
    working_dir: "/app"
    command: npm start
    restart: always
    networks:
      - bitdb
    depends_on:
      - mongo
      - bitcoin-abc
    environment:
      WAIT_HOSTS: bitcoin-abc:8332 mongo:27017

networks:
  bitdb:
